#
# Author: Timo Smieszek
#
# Code used for the Supplementary Information (pp. 2-3) of
#
# Smieszek T, Salathe M. A low-cost method to assess the epidemiological impor-
# tance of individuals in controlling infectious disease outbreaks. BMC Medicine
# 2012, XXX: XXXX.
#
#
# This code identifies and stores the location (room) of mobile motes. Input are
# raw mote files and previously derived location approximations (alg. 1 and 2).
# The identification builds on two further algorithms: (3) defining consistent
# locations within strongly connected groups of individuals, (4) defining con-
# sistent locations for instantaneously neighboring individuals.
#


###########
# Modules #
###########


import networkx as nx


###############
# Global data #
###############


COMBINATIONS = [
                (10006, 10039),
                (10031, 10061),
                (10104, 10144),
                (10002, 10025),
                (10031, 10068),
                (10002, 10028),
                (10070, 10138),
                (10031, 10062),
                (10006, 10036),
                (10025, 10075),
                (10029, 10042),
                (10019, 10033),
                (10004, 10134),
                (10031, 10065),
                (10050, 10068),
                (10007, 10149),
                (10075, 10143),
                (10050, 10062),
                (10050, 10061),
                (10145, 10153),
                (10050, 10067),
                (10145, 10155),
                (10050, 10065),
                (10049, 10151),
                (10006, 10031),
                (10059, 10082),
                (10049, 10152),
                (10023, 10126),
                (10006, 10033),
                (10023, 10122),
                (10023, 10123),
                (10002, 10029),
                (10100, 10141),
                (10005, 10071),
                (10033, 10134),
                (10006, 10034),
                (10090, 10104),
                (10090, 10105),
                (10015, 10073),
                (10015, 10075),
                (10090, 10101),
                (10007, 10141),
                (10006, 10104),
                (10006, 10107),
                (10006, 10101),
                (10006, 10100),
                (10082, 10159),
                (10021, 10169),
                (10095, 10163),
                (10095, 10162),
                (10096, 10112),
                (10095, 10167),
                (10095, 10164),
                (10095, 10169),
                (10100, 10147),
                (10033, 10152),
                (10033, 10151),
                (10033, 10156),
                (10033, 10157),
                (10088, 10138),
                (10088, 10136),
                (10088, 10137),
                (10088, 10134),
                (10088, 10130),
                (10108, 10112),
                (10033, 10136),
                (10094, 10146),
                (10108, 10114),
                (10025, 10164),
                (10104, 10141),
                (10016, 10151),
                (10062, 10082),
                (10085, 10101),
                (10085, 10107),
                (10085, 10104),
                (10015, 10135),
                (10085, 10108),
                (10138, 10144),
                (10138, 10151),
                (10017, 10049),
                (10138, 10154),
                (10138, 10155),
                (10138, 10156),
                (10138, 10159),
                (10063, 10082),
                (10036, 10118),
                (10036, 10113),
                (10036, 10112),
                (10029, 10100),
                (10017, 10043),
                (10062, 10088),
                (10131, 10137),
                (10131, 10135),
                (10131, 10134),
                (10015, 10138),
                (10131, 10138),
                (10108, 10137),
                (10050, 10063),
                (10108, 10134),
                (10043, 10123),
                (10108, 10131),
                (10017, 10107),
                (10015, 10091),
                (10017, 10104),
                (10073, 10156),
                (10145, 10152),
                (10043, 10128),
                (10017, 10100),
                (10145, 10154),
                (10075, 10146),
                (10034, 10050),
                (10075, 10145),
                (10122, 10132),
                (10122, 10131),
                (10061, 10156),
                (10059, 10081),
                (10019, 10123),
                (10019, 10122),
                (10049, 10153),
                (10122, 10136),
                (10041, 10082),
                (10122, 10165),
                (10041, 10086),
                (10101, 10108),
                (10101, 10107),
                (10041, 10089),
                (10101, 10104),
                (10154, 10156),
                (10154, 10157),
                (10081, 10101),
                (10154, 10155),
                (10129, 10167),
                (10047, 10083),
                (10047, 10082),
                (10041, 10137),
                (10096, 10151),
                (10096, 10153),
                (10043, 10137),
                (10111, 10113),
                (10007, 10059),
                (10007, 10050),
                (10005, 10146),
                (10005, 10147),
                (10005, 10145),
                (10029, 10114),
                (10068, 10129),
                (10034, 10172),
                (10080, 10163),
                (10129, 10156),
                (10129, 10153),
                (10114, 10118),
                (10105, 10156),
                (10080, 10083),
                (10125, 10153),
                (10125, 10151),
                (10125, 10156),
                (10009, 10128),
                (10005, 10033),
                (10075, 10095),
                (10016, 10050),
                (10022, 10066),
                (10050, 10091),
                (10016, 10059),
                (10082, 10091),
                (10063, 10138),
                (10071, 10138),
                (10071, 10132),
                (10141, 10146),
                (10141, 10145),
                (10071, 10137),
                (10071, 10134),
                (10003, 10045),
                (10003, 10047),
                (10003, 10041),
                (10003, 10043),
                (10021, 10167),
                (10102, 10108),
                (10047, 10067),
                (10003, 10048),
                (10156, 10157),
                (10022, 10107),
                (10016, 10128),
                (10019, 10104),
                (10016, 10124),
                (10090, 10100),
                (10016, 10126),
                (10049, 10075),
                (10016, 10120),
                (10016, 10122),
                (10016, 10123),
                (10059, 10163),
                (10169, 10171),
                (10082, 10169),
                (10039, 10091),
                (10014, 10167),
                (10128, 10162),
                (10014, 10161),
                (10073, 10100),
                (10014, 10169),
                (10022, 10156),
                (10153, 10166),
                (10009, 10124),
                (10020, 10152),
                (10083, 10101),
                (10163, 10167),
                (10020, 10151),
                (10083, 10104),
                (10110, 10122),
                (10110, 10120),
                (10083, 10108),
                (10163, 10169),
                (10073, 10143),
                (10137, 10157),
                (10031, 10050),
                (10006, 10029),
                (10112, 10169),
                (10006, 10025),
                (10006, 10022),
                (10023, 10068),
                (10006, 10021),
                (10091, 10131),
                (10128, 10154),
                (10043, 10076),
                (10145, 10165),
                (10075, 10151),
                (10145, 10167),
                (10075, 10153),
                (10075, 10154),
                (10075, 10155),
                (10050, 10076),
                (10075, 10157),
                (10072, 10104),
                (10023, 10113),
                (10023, 10112),
                (10049, 10143),
                (10023, 10118),
                (10002, 10081),
                (10090, 10138),
                (10159, 10171),
                (10120, 10127),
                (10090, 10131),
                (10094, 10101),
                (10090, 10134),
                (10090, 10136),
                (10006, 10112),
                (10015, 10067),
                (10006, 10116),
                (10006, 10117),
                (10006, 10114),
                (10006, 10115),
                (10006, 10118),
                (10120, 10123),
                (10095, 10173),
                (10033, 10125),
                (10026, 10067),
                (10033, 10123),
                (10033, 10120),
                (10004, 10095),
                (10039, 10071),
                (10039, 10070),
                (10033, 10128),
                (10028, 10082),
                (10026, 10071),
                (10028, 10086),
                (10031, 10108),
                (10065, 10146),
                (10029, 10096),
                (10120, 10128),
                (10039, 10164),
                (10083, 10134),
                (10029, 10095),
                (10029, 10169),
                (10029, 10167),
                (10029, 10164),
                (10029, 10165),
                (10029, 10162),
                (10044, 10096),
                (10138, 10164),
                (10138, 10167),
                (10029, 10090),
                (10138, 10163),
                (10074, 10161),
                (10038, 10044),
                (10138, 10169),
                (10116, 10120),
                (10052, 10085),
                (10036, 10108),
                (10036, 10104),
                (10036, 10101),
                (10015, 10074),
                (10149, 10156),
                (10017, 10067),
                (10108, 10125),
                (10052, 10171),
                (10108, 10127),
                (10108, 10120),
                (10108, 10122),
                (10044, 10086),
                (10015, 10083),
                (10044, 10082),
                (10015, 10085),
                (10153, 10169),
                (10062, 10076),
                (10034, 10068),
                (10005, 10095),
                (10130, 10173),
                (10034, 10062),
                (10034, 10066),
                (10118, 10144),
                (10118, 10147),
                (10118, 10146),
                (10118, 10143),
                (10118, 10149),
                (10118, 10148),
                (10005, 10096),
                (10075, 10147),
                (10116, 10166),
                (10071, 10075),
                (10067, 10123),
                (10019, 10134),
                (10019, 10135),
                (10049, 10064),
                (10019, 10137),
                (10041, 10091),
                (10020, 10071),
                (10091, 10128),
                (10101, 10118),
                (10041, 10095),
                (10043, 10068),
                (10091, 10123),
                (10101, 10115),
                (10043, 10065),
                (10022, 10023),
                (10043, 10063),
                (10043, 10062),
                (10096, 10143),
                (10096, 10146),
                (10096, 10147),
                (10047, 10090),
                (10047, 10091),
                (10007, 10136),
                (10075, 10081),
                (10011, 10083),
                (10045, 10059),
                (10009, 10086),
                (10009, 10083),
                (10009, 10088),
                (10068, 10169),
                (10068, 10167),
                (10068, 10164),
                (10068, 10163),
                (10065, 10075),
                (10014, 10073),
                (10075, 10126),
                (10085, 10105),
                (10077, 10128),
                (10005, 10047),
                (10102, 10167),
                (10125, 10128),
                (10082, 10113),
                (10016, 10062),
                (10063, 10128),
                (10016, 10068),
                (10082, 10086),
                (10014, 10157),
                (10071, 10147),
                (10141, 10156),
                (10009, 10091),
                (10047, 10079),
                (10102, 10137),
                (10102, 10136),
                (10156, 10169),
                (10023, 10045),
                (10047, 10071),
                (10156, 10167),
                (10156, 10166),
                (10156, 10162),
                (10016, 10112),
                (10061, 10100),
                (10061, 10101),
                (10016, 10118),
                (10061, 10108),
                (10086, 10123),
                (10086, 10122),
                (10029, 10091),
                (10164, 10171),
                (10086, 10125),
                (10164, 10172),
                (10101, 10170),
                (10086, 10128),
                (10143, 10167),
                (10073, 10113),
                (10143, 10165),
                (10143, 10164),
                (10143, 10163),
                (10039, 10083),
                (10143, 10161),
                (10073, 10115),
                (10143, 10169),
                (10120, 10153),
                (10042, 10043),
                (10042, 10044),
                (10042, 10045),
                (10042, 10047),
                (10011, 10089),
                (10042, 10049),
                (10120, 10151),
                (10075, 10088),
                (10083, 10137),
                (10122, 10167),
                (10002, 10138),
                (10110, 10131),
                (10110, 10132),
                (10071, 10095),
                (10071, 10094),
                (10002, 10137),
                (10083, 10138),
                (10002, 10044),
                (10002, 10045),
                (10002, 10047),
                (0, 10162),
                (10002, 10043),
                (0, 10163),
                (10002, 10048),
                (10002, 10049),
                (10036, 10052),
                (10075, 10169),
                (10041, 10162),
                (10025, 10095),
                (10075, 10165),
                (10075, 10164),
                (10075, 10167),
                (10075, 10163),
                (10023, 10104),
                (10123, 10128),
                (10007, 10015),
                (10071, 10131),
                (10115, 10130),
                (10115, 10134),
                (10090, 10128),
                (10090, 10122),
                (10090, 10123),
                (10090, 10120),
                (10006, 10167),
                (10006, 10163),
                (10006, 10162),
                (10006, 10161),
                (10006, 10169),
                (10095, 10145),
                (10095, 10144),
                (10095, 10146),
                (10095, 10141),
                (10095, 10143),
                (10095, 10149),
                (10039, 10068),
                (10011, 10041),
                (10011, 10042),
                (10031, 10049),
                (10011, 10045),
                (10033, 10132),
                (10011, 10047),
                (10011, 10049),
                (10039, 10063),
                (10031, 10044),
                (10039, 10067),
                (10066, 10095),
                (10049, 10107),
                (10070, 10083),
                (10073, 10151),
                (10015, 10122),
                (10085, 10164),
                (10085, 10167),
                (10011, 10082),
                (10085, 10162),
                (10138, 10173),
                (10088, 10113),
                (10085, 10169),
                (10116, 10130),
                (10125, 10137),
                (10075, 10091),
                (10159, 10163),
                (10082, 10173),
                (10026, 10123),
                (10052, 10094),
                (10036, 10130),
                (10031, 10085),
                (10036, 10134),
                (10036, 10137),
                (10036, 10136),
                (10080, 10134),
                (10031, 10082),
                (10019, 10039),
                (10137, 10152),
                (10149, 10163),
                (10019, 10035),
                (10019, 10034),
                (10149, 10167),
                (10108, 10118),
                (10035, 10048),
                (10035, 10049),
                (10035, 10047),
                (10035, 10045),
                (10108, 10115),
                (10035, 10043),
                (10035, 10041),
                (10017, 10122),
                (10017, 10125),
                (10044, 10075),
                (10052, 10168),
                (10115, 10124),
                (10050, 10171),
                (10041, 10138),
                (10041, 10131),
                (10118, 10151),
                (10034, 10072),
                (10050, 10173),
                (10118, 10154),
                (10034, 10071),
                (10080, 10164),
                (10025, 10122),
                (10091, 10146),
                (10080, 10169),
                (10082, 10131),
                (10112, 10132),
                (10015, 10153),
                (10019, 10101),
                (10052, 10067),
                (10066, 10075),
                (10066, 10074),
                (10091, 10138),
                (10101, 10120),
                (10101, 10123),
                (10101, 10122),
                (10101, 10125),
                (10043, 10074),
                (10101, 10128),
                (10091, 10132),
                (10043, 10070),
                (10043, 10071),
                (10043, 10072),
                (10091, 10137),
                (10096, 10137),
                (10096, 10136),
                (10096, 10135),
                (10100, 10163),
                (10100, 10164),
                (10096, 10130),
                (10100, 10169),
                (10108, 10130),
                (10033, 10065),
                (10044, 10091),
                (10077, 10144),
                (10152, 10156),
                (10047, 10123),
                (10033, 10154),
                (10111, 10134),
                (10111, 10137),
                (10111, 10136),
                (10111, 10130),
                (10048, 10082),
                (10065, 10096),
                (10048, 10086),
                (10021, 10029),
                (10065, 10097),
                (10113, 10123),
                (10071, 10159),
                (10009, 10095),
                (10009, 10096),
                (10009, 10090),
                (0, 10164),
                (10102, 10122),
                (0, 10166),
                (0, 10167),
                (10120, 10156),
                (10120, 10155),
                (10120, 10154),
                (0, 10169),
                (10068, 10173),
                (10049, 10074),
                (10125, 10134),
                (10033, 10034),
                (10137, 10159),
                (10009, 10164),
                (10125, 10131),
                (10009, 10167),
                (10137, 10153),
                (10009, 10169),
                (10137, 10151),
                (10003, 10020),
                (10125, 10138),
                (10137, 10156),
                (10137, 10155),
                (10137, 10154),
                (10049, 10070),
                (10156, 10173),
                (10023, 10029),
                (10141, 10163),
                (10089, 10123),
                (10141, 10164),
                (10141, 10169),
                (10071, 10156),
                (10089, 10104),
                (10003, 10021),
                (10061, 10138),
                (10006, 10074),
                (10156, 10171),
                (10047, 10049),
                (10047, 10048),
                (10061, 10130),
                (10061, 10132),
                (10061, 10134),
                (10061, 10137),
                (10016, 10104),
                (10016, 10100),
                (10016, 10101),
                (10111, 10162),
                (10089, 10101),
                (10016, 10108),
                (10016, 10074),
                (10112, 10143),
                (10086, 10131),
                (10086, 10132),
                (10086, 10134),
                (10112, 10146),
                (10086, 10137),
                (10086, 10138),
                (10112, 10149),
                (10112, 10148),
                (10073, 10167),
                (10025, 10152),
                (10081, 10162),
                (10073, 10162),
                (10073, 10161),
                (10081, 10167),
                (10022, 10152),
                (10042, 10075),
                (10101, 10156),
                (10083, 10128),
                (10083, 10123),
                (10083, 10125),
                (10002, 10101),
                (10071, 10083),
                (10022, 10049),
                (10002, 10105),
                (10020, 10132),
                (10123, 10131),
                (10022, 10042),
                (10016, 10073),
                (10071, 10088),
                (10022, 10041),
                (10022, 10047),
                (10022, 10044),
                (10016, 10075),
                (10050, 10052),
                (10081, 10095),
                (10081, 10097),
                (10088, 10095),
                (10072, 10123),
                (10123, 10130),
                (10164, 10169),
                (10123, 10137),
                (10123, 10134),
                (10123, 10138),
                (10031, 10143),
                (10045, 10095),
                (10031, 10141),
                (10115, 10122),
                (10045, 10091),
                (10115, 10120),
                (10031, 10144),
                (10031, 10149),
                (10049, 10090),
                (10049, 10091),
                (10095, 10152),
                (10095, 10153),
                (10095, 10151),
                (10095, 10156),
                (10095, 10154),
                (10095, 10155),
                (10033, 10101),
                (10033, 10100),
                (10033, 10104),
                (10002, 10079),
                (10011, 10076),
                (10045, 10164),
                (10011, 10073),
                (10011, 10072),
                (10031, 10036),
                (10039, 10057),
                (10002, 10072),
                (10031, 10033),
                (10002, 10074),
                (10081, 10145),
                (10066, 10082),
                (10029, 10075),
                (10082, 10153),
                (10021, 10081),
                (10021, 10082),
                (10085, 10153),
                (10085, 10155),
                (10085, 10154),
                (10085, 10156),
                (10025, 10151),
                (10085, 10146),
                (10036, 10124),
                (10036, 10122),
                (10036, 10123),
                (10036, 10120),
                (10113, 10167),
                (10036, 10128),
                (10005, 10137),
                (10019, 10022),
                (10060, 10070),
                (10019, 10020),
                (10019, 10021),
                (10076, 10088),
                (10120, 10131),
                (10005, 10135),
                (10076, 10081),
                (10076, 10082),
                (10076, 10085),
                (10076, 10086),
                (10017, 10137),
                (10050, 10097),
                (10052, 10156),
                (10016, 10089),
                (10017, 10131),
                (10017, 10138),
                (10034, 10083),
                (10034, 10082),
                (10002, 10022),
                (10065, 10123),
                (10041, 10120),
                (10118, 10126),
                (10118, 10125),
                (10041, 10124),
                (10118, 10122),
                (10118, 10120),
                (10046, 10134),
                (10029, 10076),
                (10039, 10141),
                (10146, 10156),
                (10002, 10008),
                (10146, 10154),
                (10146, 10153),
                (10146, 10151),
                (10066, 10067),
                (10034, 10089),
                (10101, 10137),
                (10101, 10134),
                (10101, 10132),
                (10091, 10108),
                (10101, 10130),
                (10043, 10046),
                (10043, 10049),
                (10091, 10104),
                (10021, 10061),
                (10091, 10101),
                (10091, 10100),
                (10101, 10138),
                (10100, 10155),
                (10100, 10151),
                (10096, 10122),
                (10159, 10169),
                (10111, 10122),
                (10111, 10123),
                (10120, 10135),
                (10111, 10153),
                (10071, 10082),
                (10007, 10086),
                (10007, 10082),
                (10022, 10065),
                (10007, 10089),
                (10022, 10048),
                (10050, 10071),
                (10120, 10134),
                (10071, 10086),
                (10002, 10104),
                (10002, 10107),
                (10050, 10090),
                (10122, 10153),
                (10122, 10155),
                (10122, 10154),
                (10122, 10156),
                (0, 10151),
                (0, 10153),
                (10120, 10143),
                (0, 10155),
                (10120, 10146),
                (0, 10156),
                (0, 10159),
                (10114, 10147),
                (10114, 10146),
                (10020, 10138),
                (10139, 10146),
                (10151, 10156),
                (0, 10083),
                (0, 10082),
                (0, 10081),
                (0, 10086),
                (0, 10085),
                (10007, 10153),
                (10137, 10141),
                (0, 10089),
                (0, 10088),
                (10137, 10144),
                (10137, 10145),
                (10007, 10155),
                (10007, 10154),
                (10067, 10149),
                (10080, 10128),
                (10071, 10163),
                (10071, 10164),
                (10071, 10169),
                (10003, 10035),
                (10020, 10035),
                (10020, 10034),
                (10047, 10057),
                (10061, 10128),
                (10023, 10167),
                (10061, 10123),
                (10061, 10120),
                (10068, 10097),
                (10100, 10112),
                (10068, 10091),
                (10068, 10090),
                (10086, 10105),
                (10112, 10151),
                (10086, 10101),
                (10086, 10100),
                (10022, 10144),
                (10143, 10145),
                (10086, 10108),
                (10143, 10146),
                (10081, 10155),
                (10081, 10154),
                (10081, 10157),
                (10081, 10156),
                (10081, 10151),
                (10081, 10153),
                (10042, 10062),
                (10110, 10118),
                (10020, 10101),
                (10083, 10156),
                (10110, 10112),
                (10110, 10113),
                (10083, 10151),
                (10015, 10059),
                (10039, 10061),
                (10063, 10100),
                (10022, 10034),
                (10002, 10118),
                (10023, 10137),
                (10050, 10164),
                (10014, 10081),
                (10014, 10082),
                (10014, 10085),
                (10075, 10107),
                (10075, 10104),
                (10075, 10101),
                (10029, 10156),
                (10004, 10006),
                (10075, 10108),
                (10123, 10146),
                (10123, 10145),
                (10123, 10143),
                (10123, 10141),
                (10124, 10125),
                (10123, 10149),
                (10064, 10163),
                (10031, 10151),
                (10050, 10162),
                (10031, 10153),
                (10031, 10154),
                (10031, 10155),
                (10031, 10156),
                (10064, 10164),
                (10006, 10143),
                (10006, 10145),
                (10006, 10144),
                (10006, 10147),
                (10006, 10146),
                (10095, 10129),
                (10095, 10128),
                (10095, 10127),
                (10095, 10125),
                (10095, 10124),
                (10095, 10123),
                (10095, 10122),
                (10095, 10120),
                (10065, 10088),
                (10033, 10118),
                (0, 10060),
                (10065, 10080),
                (10065, 10083),
                (10065, 10082),
                (10011, 10066),
                (10065, 10086),
                (10049, 10061),
                (10045, 10154),
                (10049, 10063),
                (10020, 10072),
                (10045, 10151),
                (10039, 10047),
                (10002, 10068),
                (10049, 10066),
                (10002, 10066),
                (10002, 10067),
                (10002, 10065),
                (10002, 10062),
                (10002, 10063),
                (10132, 10163),
                (10132, 10164),
                (10132, 10169),
                (10020, 10076),
                (10075, 10076),
                (10068, 10112),
                (10081, 10116),
                (10021, 10091),
                (10062, 10077),
                (10049, 10082),
                (10062, 10075),
                (10062, 10074),
                (10085, 10143),
                (10062, 10071),
                (10062, 10070),
                (10101, 10162),
                (10116, 10155),
                (10116, 10156),
                (10014, 10068),
                (10104, 10127),
                (10116, 10153),
                (10014, 10062),
                (10041, 10108),
                (10026, 10149),
                (10113, 10155),
                (10113, 10154),
                (10113, 10156),
                (10113, 10153),
                (10015, 10052),
                (10017, 10095),
                (10060, 10063),
                (10023, 10130),
                (10031, 10104),
                (10014, 10029),
                (10062, 10101),
                (10062, 10100),
                (10062, 10104),
                (10076, 10096),
                (10076, 10094),
                (10076, 10095),
                (10061, 10095),
                (10034, 10095),
                (10102, 10147),
                (10036, 10068),
                (10036, 10065),
                (10118, 10130),
                (10036, 10062),
                (10118, 10132),
                (10080, 10100),
                (10047, 10072),
                (10066, 10120),
                (10115, 10123),
                (10019, 10164),
                (10019, 10163),
                (10031, 10145),
                (10146, 10148),
                (10019, 10169),
                (10015, 10169),
                (10035, 10151),
                (10035, 10152),
                (10015, 10163),
                (10015, 10162),
                (10021, 10072),
                (10021, 10073),
                (10015, 10167),
                (10021, 10075),
                (10021, 10076),
                (10015, 10164),
                (10041, 10050),
                (10104, 10138),
                (10152, 10172),
                (10136, 10146),
                (10104, 10133),
                (10104, 10132),
                (10104, 10131),
                (10104, 10137),
                (10054, 10065),
                (10007, 10094),
                (10007, 10095),
                (10007, 10036),
                (10019, 10075),
                (10034, 10075),
                (10082, 10152),
                (10093, 10123),
                (10122, 10149),
                (10122, 10146),
                (10122, 10147),
                (10122, 10145),
                (10050, 10075),
                (10122, 10143),
                (10063, 10169),
                (10007, 10090),
                (10068, 10154),
                (10050, 10095),
                (0, 10146),
                (0, 10147),
                (0, 10145),
                (10006, 10076),
                (10082, 10154),
                (10067, 10173),
                (10006, 10071),
                (10009, 10141),
                (10009, 10144),
                (10157, 10167),
                (0, 10090),
                (0, 10094),
                (0, 10095),
                (0, 10096),
                (10091, 10163),
                (10007, 10143),
                (10007, 10144),
                (10007, 10145),
                (10007, 10146),
                (10007, 10147),
                (10050, 10154),
                (10050, 10153),
                (10050, 10152),
                (10015, 10095),
                (10020, 10028),
                (10082, 10095),
                (10097, 10120),
                (10020, 10022),
                (10102, 10146),
                (10020, 10021),
                (10054, 10083),
                (10009, 10151),
                (10128, 10156),
                (10033, 10049),
                (10043, 10100),
                (10026, 10046),
                (10068, 10086),
                (10091, 10169),
                (10068, 10082),
                (10068, 10083),
                (10015, 10128),
                (10068, 10088),
                (10068, 10089),
                (10073, 10149),
                (10022, 10151),
                (10059, 10161),
                (10169, 10173),
                (10059, 10167),
                (10022, 10155),
                (10027, 10149),
                (10143, 10156),
                (10081, 10143),
                (10143, 10155),
                (10073, 10145),
                (10143, 10153),
                (10082, 10164),
                (10050, 10100),
                (10050, 10101),
                (10050, 10104),
                (10050, 10108),
                (10074, 10169),
                (10008, 10049),
                (10046, 10149),
                (10083, 10149),
                (10031, 10137),
                (10083, 10145),
                (10074, 10162),
                (10008, 10041),
                (10074, 10164),
                (10083, 10141),
                (10074, 10166),
                (10074, 10167),
                (10061, 10067),
                (10061, 10065),
                (10022, 10028),
                (10061, 10062),
                (10153, 10164),
                (10011, 10071),
                (10034, 10149),
                (10153, 10167),
                (10153, 10161),
                (10153, 10162),
                (10061, 10068),
                (10008, 10011),
                (10029, 10043),
                (10074, 10136),
                (10112, 10165),
                (10045, 10167),
                (10027, 10033),
                (10014, 10095),
                (10045, 10169),
                (10034, 10146),
                (10033, 10052),
                (10033, 10050),
                (10042, 10123),
                (10075, 10115),
                (10075, 10116),
                (10031, 10034),
                (10075, 10112),
                (10046, 10061),
                (10002, 10075),
                (10123, 10154),
                (10123, 10155),
                (10123, 10156),
                (10123, 10151),
                (10123, 10152),
                (10123, 10153),
                (10086, 10112),
                (10123, 10159),
                (10086, 10115),
                (10031, 10164),
                (10031, 10167),
                (10031, 10163),
                (10031, 10162),
                (10006, 10156),
                (10003, 10049),
                (10006, 10154),
                (10006, 10155),
                (10031, 10169),
                (10006, 10153),
                (10006, 10151),
                (10095, 10138),
                (10022, 10029),
                (10095, 10134),
                (10095, 10136),
                (10095, 10137),
                (10095, 10130),
                (10095, 10131),
                (10066, 10083),
                (10045, 10149),
                (10088, 10120),
                (10011, 10019),
                (10011, 10017),
                (10011, 10016),
                (10065, 10095),
                (10045, 10146),
                (10065, 10091),
                (10072, 10075),
                (10002, 10091),
                (10002, 10090),
                (10049, 10072),
                (10002, 10095),
                (10049, 10071),
                (10070, 10164),
                (10005, 10110),
                (10062, 10068),
                (10062, 10064),
                (10062, 10065),
                (10062, 10067),
                (10049, 10096),
                (10062, 10063),
                (10027, 10143),
                (10117, 10165),
                (10116, 10162),
                (10062, 10163),
                (10116, 10167),
                (10011, 10123),
                (10039, 10149),
                (10014, 10059),
                (10039, 10143),
                (10011, 10128),
                (10014, 10074),
                (10014, 10075),
                (10062, 10164),
                (10115, 10155),
                (10017, 10082),
                (10021, 10122),
                (10007, 10041),
                (10035, 10094),
                (10044, 10049),
                (10035, 10091),
                (10062, 10115),
                (10031, 10122),
                (10044, 10045),
                (10068, 10156),
                (10039, 10123),
                (10041, 10100),
                (10041, 10101),
                (10031, 10125),
                (10041, 10104),
                (10036, 10074),
                (10036, 10075),
                (10036, 10077),
                (10036, 10073),
                (10047, 10159),
                (10146, 10170),
                (10014, 10166),
                (10047, 10062),
                (10039, 10090),
                (10033, 10064),
                (10091, 10167),
                (10091, 10164),
                (10021, 10049),
                (10021, 10045),
                (10113, 10143),
                (10113, 10146),
                (10113, 10147),
                (10021, 10043),
                (10113, 10145),
                (10046, 10071),
                (10033, 10061),
                (10104, 10128),
                (10120, 10169),
                (10043, 10088),
                (10104, 10120),
                (10111, 10145),
                (10104, 10122),
                (10043, 10086),
                (10034, 10137),
                (10043, 10080),
                (10043, 10083),
                (10043, 10082),
                (0, 10034),
                (0, 10038),
                (10120, 10162),
                (10094, 10095),
                (10120, 10167),
                (10120, 10165),
                (10047, 10101),
                (0, 10138),
                (0, 10132),
                (0, 10131),
                (0, 10130),
                (0, 10137),
                (0, 10136),
                (0, 10134),
                (10027, 10062),
                (10067, 10169),
                (10009, 10138),
                (10009, 10137),
                (10067, 10163),
                (10067, 10164),
                (10009, 10132),
                (10009, 10131),
                (10009, 10130),
                (10137, 10162),
                (10137, 10163),
                (10137, 10161),
                (10137, 10167),
                (10137, 10164),
                (10137, 10165),
                (10100, 10137),
                (10096, 10104),
                (10137, 10169),
                (10100, 10132),
                (10096, 10100),
                (10074, 10089),
                (10074, 10088),
                (10074, 10085),
                (10074, 10082),
                (10074, 10081),
                (0, 10047),
                (0, 10046),
                (0, 10045),
                (0, 10044),
                (0, 10043),
                (0, 10041),
                (10046, 10067),
                (0, 10049),
                (10083, 10100),
                (10021, 10023),
                (10163, 10164),
                (10009, 10043),
                (10009, 10163),
                (10009, 10041),
                (10093, 10130),
                (10093, 10134),
                (10022, 10165),
                (10128, 10149),
                (10081, 10137),
                (10128, 10141),
                (10073, 10155),
                (10073, 10153),
                (10128, 10146),
                (10081, 10130),
                (10050, 10134),
                (10050, 10137),
                (10050, 10131),
                (10050, 10130),
                (10059, 10153),
                (10050, 10138),
                (10046, 10152),
                (10083, 10172),
                (10074, 10155),
                (10074, 10154),
                (10074, 10156),
                (10074, 10151),
                (10074, 10153),
                (10016, 10021),
                (10016, 10022),
                (10077, 10097),
                (10153, 10154),
                (10153, 10157),
                (10153, 10156),
                (10063, 10164),
                (10112, 10113),
                (10063, 10163),
                (10002, 10057),
                (10009, 10134),
                (10009, 10133),
                (10041, 10128),
                (10027, 10046),
                (10033, 10044),
                (10049, 10137),
                (10033, 10046),
                (10033, 10047),
                (10033, 10041),
                (10033, 10043),
                (10123, 10169),
                (10042, 10131),
                (10042, 10134),
                (10042, 10137),
                (10054, 10086),
                (10123, 10163),
                (10123, 10162),
                (10123, 10164),
                (10123, 10167),
                (10086, 10169),
                (10086, 10164),
                (10086, 10163),
                (10089, 10149),
                (10100, 10138),
                (10089, 10167),
                (10095, 10101),
                (10095, 10104),
                (10095, 10107),
                (10026, 10094),
                (10100, 10134),
                (10026, 10091),
                (10045, 10137),
                (10065, 10068),
                (10007, 10156),
                (10044, 10107),
                (10023, 10034),
                (10002, 10083),
                (10002, 10085),
                (10002, 10086),
                (10023, 10031),
                (10002, 10088),
                (10002, 10089),
                (10080, 10101),
                (10112, 10125),
                (10006, 10091),
                (10132, 10144),
                (10132, 10147),
                (10132, 10146),
                (10132, 10141),
                (10041, 10048),
                (10132, 10149),
                (10043, 10107),
                (10028, 10163),
                (10028, 10164),
                (10052, 10154),
                (10076, 10113),
                (10009, 10042),
                (10029, 10089),
                (10045, 10047),
                (10011, 10138),
                (10031, 10173),
                (10045, 10049),
                (10029, 10082),
                (10039, 10154),
                (10014, 10043),
                (10017, 10073),
                (10017, 10072),
                (10008, 10022),
                (10017, 10075),
                (10045, 10113),
                (10021, 10097),
                (10005, 10126),
                (10117, 10120),
                (10117, 10122),
                (10035, 10086),
                (10017, 10035),
                (10062, 10125),
                (10029, 10136),
                (10062, 10123),
                (10062, 10122),
                (10047, 10129),
                (10011, 10021),
                (10052, 10120),
                (10062, 10128),
                (10107, 10130),
                (10107, 10134),
                (10107, 10137),
                (10107, 10138),
                (10029, 10132),
                (10075, 10152),
                (10104, 10159),
                (10080, 10123),
                (10145, 10166),
                (10054, 10094),
                (10122, 10130),
                (10097, 10142),
                (10097, 10147),
                (10101, 10141),
                (10097, 10145),
                (10005, 10128),
                (10075, 10156),
                (10146, 10169),
                (10146, 10167),
                (10146, 10164),
                (10025, 10082),
                (10146, 10162),
                (10146, 10163),
                (10101, 10146),
                (10134, 10136),
                (10118, 10128),
                (10044, 10147),
                (10044, 10146),
                (10113, 10139),
                (10015, 10145),
                (10015, 10147),
                (0, 10048),
                (10113, 10132),
                (10113, 10131),
                (10113, 10130),
                (10050, 10074),
                (10102, 10120),
                (10067, 10088),
                (10067, 10086),
                (10134, 10173),
                (10067, 10083),
                (10067, 10082),
                (10067, 10080),
                (10034, 10128),
                (10043, 10090),
                (10043, 10091),
                (10104, 10118),
                (10043, 10094),
                (10043, 10095),
                (10104, 10114),
                (10104, 10117),
                (10034, 10123),
                (10104, 10111),
                (10104, 10110),
                (10104, 10113),
                (10104, 10112),
                (10036, 10153),
                (10066, 10145),
                (10078, 10088),
                (10013, 10059),
                (10135, 10137),
                (10135, 10136),
                (10033, 10059),
                (0, 10128),
                (10047, 10137),
                (0, 10120),
                (10003, 10167),
                (0, 10122),
                (0, 10123),
                (0, 10124),
                (0, 10126),
                (0, 10127),
                (10130, 10149),
                (10067, 10159),
                (10114, 10131),
                (10130, 10143),
                (10009, 10125),
                (10130, 10141),
                (10067, 10156),
                (10130, 10147),
                (10130, 10146),
                (10130, 10145),
                (10007, 10162),
                (10007, 10161),
                (10100, 10128),
                (10007, 10167),
                (10100, 10124),
                (10100, 10123),
                (10074, 10095),
                (10074, 10096),
                (10074, 10097),
                (10033, 10095),
                (10066, 10104),
                (0, 10050),
                (0, 10052),
                (10020, 10045),
                (10068, 10147),
                (0, 10059),
                (10020, 10042),
                (10020, 10043),
                (10006, 10113),
                (10050, 10143),
                (10009, 10050),
                (10093, 10146),
                (10059, 10145),
                (10050, 10128),
                (10059, 10146),
                (10082, 10149),
                (10059, 10143),
                (10025, 10118),
                (10050, 10123),
                (10025, 10112),
                (10082, 10143),
                (10081, 10123),
                (10006, 10052),
                (10075, 10128),
                (10074, 10143),
                (10074, 10146),
                (10083, 10163),
                (10074, 10144),
                (10074, 10145),
                (10074, 10149),
                (10008, 10021),
                (10083, 10169),
                (10016, 10034),
                (10105, 10108),
                (10016, 10033),
                (10016, 10031),
                (10043, 10045),
                (10073, 10095),
                (10073, 10154),
                (10128, 10143),
                (10043, 10047),
                (10002, 10149),
                (10101, 10131),
                (10118, 10138),
                (10033, 10071),
                (10021, 10063),
                (10033, 10072),
                (10033, 10075),
                (10081, 10131),
                (10075, 10138),
                (10033, 10076),
                (10075, 10137),
                (10025, 10029),
                (10075, 10130),
                (10031, 10112),
                (10042, 10101),
                (10021, 10067),
                (10123, 10172),
                (10123, 10173),
                (10123, 10170),
                (10021, 10066),
                (10008, 10151),
                (10008, 10152),
                (10022, 10172),
                (10021, 10163),
                (10089, 10155),
                (10089, 10154),
                (10089, 10156),
                (10089, 10153),
                (10095, 10116),
                (10095, 10117),
                (10095, 10115),
                (10095, 10112),
                (10095, 10113),
                (10095, 10111),
                (10096, 10120),
                (10026, 10080),
                (10026, 10087),
                (10095, 10118),
                (10065, 10071),
                (10004, 10031),
                (10011, 10034),
                (10065, 10076),
                (10045, 10124),
                (10029, 10061),
                (10029, 10065),
                (10006, 10088),
                (10006, 10089),
                (10006, 10086),
                (10006, 10081),
                (10006, 10082),
                (10006, 10083),
                (10014, 10021),
                (10088, 10143),
                (10088, 10141),
                (10033, 10081),
                (10029, 10068),
                (10021, 10059),
                (10076, 10101),
                (10005, 10130),
                (10076, 10104),
                (10014, 10050),
                (10031, 10107),
                (10033, 10091),
                (10033, 10090),
                (10064, 10156),
                (10031, 10102),
                (10031, 10101),
                (10033, 10094),
                (10118, 10136),
                (10008, 10034),
                (10017, 10066),
                (10046, 10141),
                (10008, 10033),
                (10062, 10138),
                (10104, 10123),
                (10117, 10118),
                (10062, 10132),
                (10062, 10134),
                (10118, 10137),
                (10061, 10074),
                (10131, 10169),
                (10085, 10095),
                (10153, 10155),
                (10132, 10156),
                (10043, 10151),
                (10080, 10132),
                (10036, 10050),
                (10043, 10159),
                (10097, 10153),
                (10041, 10169),
                (10080, 10138),
                (10003, 10086),
                (10104, 10125),
                (10016, 10029),
                (10134, 10138),
                (10019, 10152),
                (10134, 10137),
                (10019, 10151),
                (10016, 10147),
                (10021, 10027),
                (10044, 10151),
                (10021, 10025),
                (10015, 10151),
                (10015, 10156),
                (10021, 10022),
                (10015, 10154),
                (10015, 10155),
                (10113, 10124),
                (10113, 10125),
                (10113, 10120),
                (10113, 10122),
                (10021, 10028),
                (10067, 10094),
                (10067, 10095),
                (10067, 10090),
                (10067, 10091),
                (10007, 10088),
                (10111, 10167),
                (10034, 10118),
                (10104, 10105),
                (10034, 10115),
                (10104, 10108),
                (10066, 10151),
                (10066, 10152),
                (10066, 10155),
                (10066, 10156),
                (10005, 10136),
                (0, 10113),
                (0, 10112),
                (10047, 10122),
                (10005, 10139),
                (0, 10118),
                (10017, 10047),
                (10015, 10017),
                (10067, 10143),
                (10067, 10141),
                (10067, 10146),
                (10067, 10144),
                (10067, 10145),
                (10130, 10153),
                (10130, 10154),
                (10130, 10155),
                (10130, 10156),
                (10007, 10117),
                (10007, 10116),
                (10100, 10113),
                (10007, 10114),
                (10007, 10113),
                (10007, 10112),
                (10007, 10111),
                (10007, 10110),
                (10007, 10118),
                (10067, 10137),
                (0, 10062),
                (0, 10065),
                (0, 10067),
                (0, 10068),
                (10075, 10123),
                (10075, 10122),
                (10075, 10124),
                (10009, 10065),
                (10122, 10151),
                (10007, 10029),
                (10009, 10061),
                (10009, 10062),
                (10007, 10023),
                (10107, 10164),
                (10007, 10021),
                (10073, 10124),
                (10009, 10068),
                (10007, 10025),
                (10081, 10111),
                (10128, 10163),
                (10082, 10151),
                (10081, 10115),
                (10128, 10167),
                (10128, 10164),
                (10025, 10104),
                (10050, 10156),
                (10128, 10169),
                (10025, 10100),
                (10035, 10042),
                (10077, 10163),
                (10046, 10050),
                (10074, 10137),
                (10068, 10141),
                (10074, 10134),
                (10074, 10132),
                (10074, 10131),
                (10074, 10130),
                (10046, 10138),
                (10068, 10143),
                (10074, 10138),
                (10105, 10118),
                (0, 10152),
                (10073, 10088),
                (10033, 10035),
                (10105, 10110),
                (10105, 10112),
                (10105, 10114),
                (10073, 10082),
                (0, 10157),
                (10027, 10061),
                (10120, 10147),
                (10027, 10064),
                (10027, 10067),
                (10033, 10066),
                (10033, 10067),
                (10042, 10118),
                (10086, 10094),
                (10033, 10062),
                (10033, 10063),
                (10086, 10091),
                (10086, 10090),
                (10025, 10038),
                (10025, 10039),
                (10033, 10068),
                (10065, 10108),
                (10020, 10049),
                (10065, 10100),
                (10065, 10101),
                (10065, 10104),
                (10086, 10141),
                (10086, 10143),
                (10112, 10118),
                (10086, 10144),
                (10097, 10164),
                (10086, 10149),
                (10112, 10115),
                (10020, 10091),
                (0, 10017),
                (10059, 10156),
                (10059, 10154),
                (10059, 10155),
                (10089, 10143),
                (10049, 10131),
                (10089, 10146),
                (10089, 10147),
                (10049, 10134),
                (10049, 10138),
                (10145, 10161),
                (10004, 10021),
                (10011, 10022),
                (10011, 10023),
                (10083, 10095),
                (10031, 10083),
                (10014, 10118),
                (10011, 10028),
                (10011, 10029),
                (10113, 10162),
                (10088, 10151),
                (10088, 10153),
                (10088, 10154),
                (10023, 10041),
                (10088, 10156),
                (10134, 10147),
                (10006, 10059),
                (10031, 10077),
                (10006, 10050),
                (10015, 10061),
                (10007, 10170),
                (10076, 10138),
                (10137, 10149),
                (10076, 10134),
                (10076, 10137),
                (10076, 10130),
                (10076, 10132),
                (10033, 10088),
                (10045, 10066),
                (10045, 10061),
                (10045, 10063),
                (10033, 10080),
                (10031, 10115),
                (10031, 10116),
                (10033, 10083),
                (10031, 10111),
                (10033, 10086),
                (10031, 10113),
                (10009, 10152),
                (10019, 10090),
                (10110, 10126),
                (10062, 10149),
                (10113, 10165),
                (10022, 10104),
                (10062, 10144),
                (10062, 10143),
                (10007, 10151),
                (10062, 10141),
                (10021, 10100),
                (10021, 10101),
                (10137, 10143),
                (10021, 10104),
                (10015, 10016),
                (10015, 10019),
                (10021, 10041),
                (10137, 10146),
                (10137, 10147),
                (10043, 10141),
                (10050, 10167),
                (10043, 10149),
                (10097, 10167),
                (10097, 10162),
                (10094, 10154),
                (10028, 10035),
                (10028, 10034),
                (10091, 10151),
                (10134, 10143),
                (10134, 10141),
                (10050, 10163),
                (10091, 10159),
                (10091, 10156),
                (10052, 10073),
                (10091, 10155),
                (10052, 10076),
                (10006, 10009),
                (10021, 10034),
                (10015, 10125),
                (10029, 10118),
                (10113, 10115),
                (10021, 10031),
                (10015, 10120),
                (10029, 10113),
                (10113, 10118),
                (10029, 10111),
                (10062, 10091),
                (10062, 10090),
                (10062, 10093),
                (10113, 10114),
                (10078, 10134),
                (10062, 10095),
                (10034, 10101),
                (10034, 10107),
                (10034, 10104),
                (10029, 10112),
                (10065, 10067),
                (10034, 10108),
                (10080, 10094),
                (10066, 10169),
                (10029, 10117),
                (10005, 10089),
                (10066, 10162),
                (10050, 10122),
                (10015, 10050),
                (10103, 10122),
                (10041, 10151),
                (10041, 10153),
                (10041, 10152),
                (10041, 10155),
                (10041, 10154),
                (10005, 10120),
                (10120, 10130),
                (10005, 10122),
                (0, 10101),
                (10005, 10125),
                (0, 10104),
                (0, 10105),
                (10120, 10139),
                (10047, 10156),
                (10047, 10154),
                (10047, 10151),
                (10145, 10146),
                (10005, 10082),
                (10045, 10130),
                (10039, 10043),
                (10137, 10138),
                (10009, 10104),
                (10009, 10105),
                (10130, 10169),
                (10036, 10088),
                (10009, 10100),
                (10009, 10101),
                (10036, 10085),
                (10130, 10164),
                (10130, 10167),
                (10130, 10166),
                (10036, 10081),
                (10002, 10082),
                (10130, 10162),
                (10007, 10104),
                (10007, 10105),
                (10007, 10107),
                (10007, 10100),
                (10007, 10101),
                (10007, 10102),
                (10100, 10101),
                (10007, 10108),
                (10020, 10066),
                (10020, 10062),
                (10020, 10061),
                (0, 10077),
                (0, 10074),
                (0, 10075),
                (10006, 10095),
                (10020, 10033),
                (10009, 10071),
                (10009, 10076),
                (10007, 10039),
                (10162, 10170),
                (10007, 10031),
                (10041, 10113),
                (10007, 10033),
                (10007, 10034),
                (10006, 10108),
                (10081, 10107),
                (10082, 10123),
                (10082, 10122),
                (10025, 10137),
                (10082, 10120),
                (10050, 10146),
                (10050, 10141),
                (10082, 10128),
                (10046, 10108),
                (10094, 10108),
                (10046, 10101),
                (10046, 10100),
                (10074, 10124),
                (10074, 10120),
                (10074, 10122),
                (10074, 10123),
                (10129, 10130),
                (10074, 10128),
                (10074, 10129),
                (10104, 10124),
                (10045, 10143),
                (10046, 10169),
                (10105, 10125),
                (10039, 10172),
                (10105, 10120),
                (10105, 10122),
                (10019, 10138),
                (10027, 10074),
                (10027, 10071),
                (10086, 10087),
                (10095, 10097),
                (10017, 10145),
                (10042, 10165),
                (10086, 10088),
                (10065, 10138),
                (10065, 10134),
                (10065, 10137),
                (10065, 10131),
                (10065, 10130),
                (10086, 10156),
                (10112, 10120),
                (10086, 10154),
                (10112, 10122),
                (10086, 10152),
                (10086, 10153),
                (10059, 10129),
                (10112, 10126),
                (10112, 10129),
                (10020, 10082),
                (10020, 10083),
                (10059, 10123),
                (10059, 10120),
                (10049, 10123),
                (10086, 10104),
                (10089, 10138),
                (10076, 10118),
                (10112, 10154),
                (10120, 10149),
                (10022, 10146),
                (10014, 10101),
                (10124, 10137),
                (10014, 10104),
                (10124, 10130),
                (10045, 10100),
                (10014, 10108),
                (10025, 10068),
                (10025, 10050),
                (10015, 10043),
                (10088, 10169),
                (10022, 10043),
                (10028, 10152),
                (10088, 10164),
                (10039, 10041),
                (10028, 10151),
                (10028, 10156),
                (10102, 10104),
                (10088, 10163),
                (10088, 10162),
                (10043, 10067),
                (10025, 10033),
                (10091, 10122),
                (10006, 10041),
                (10006, 10042),
                (10006, 10044),
                (10006, 10045),
                (10023, 10089),
                (10006, 10047),
                (10076, 10122),
                (10076, 10123),
                (10043, 10064),
                (10076, 10126),
                (10076, 10124),
                (10045, 10072),
                (10045, 10073),
                (10076, 10128),
                (10045, 10071),
                (10045, 10074),
                (10045, 10075),
                (10031, 10120),
                (10029, 10073),
                (10064, 10138),
                (10101, 10112),
                (10039, 10101),
                (10031, 10126),
                (10031, 10129),
                (10031, 10128),
                (10041, 10156),
                (10064, 10130),
                (10064, 10131),
                (10019, 10086),
                (0, 10100),
                (10019, 10082),
                (10019, 10083),
                (10062, 10159),
                (10136, 10147),
                (10062, 10155),
                (10062, 10156),
                (10091, 10094),
                (10090, 10156),
                (10062, 10152),
                (10021, 10134),
                (10021, 10137),
                (10120, 10137),
                (10029, 10088),
                (10107, 10167),
                (10107, 10166),
                (10120, 10136),
                (10132, 10138),
                (10132, 10134),
                (0, 10108),
                (10132, 10133),
                (10043, 10172),
                (10047, 10152),
                (10065, 10154),
                (10039, 10151),
                (10134, 10154),
                (10065, 10153),
                (10134, 10156),
                (10031, 10043),
                (10134, 10151),
                (10039, 10153),
                (10083, 10159),
                (10074, 10075),
                (10029, 10108),
                (10062, 10083),
                (10062, 10080),
                (10015, 10137),
                (10062, 10086),
                (10015, 10131),
                (10017, 10042),
                (10029, 10101),
                (10029, 10102),
                (10017, 10041),
                (10029, 10104),
                (10029, 10105),
                (10017, 10044),
                (10083, 10153),
                (10020, 10104),
                (10046, 10054),
                (10108, 10169),
                (10080, 10086),
                (10118, 10156),
                (10104, 10169),
                (10022, 10137),
                (10161, 10167),
                (10035, 10039),
                (10041, 10149),
                (10041, 10144),
                (10014, 10123),
                (10005, 10115),
                (10005, 10117),
                (10120, 10125),
                (10120, 10122),
                (10005, 10113),
                (10005, 10112),
                (10022, 10131),
                (10005, 10118),
                (10005, 10075),
                (10120, 10129),
                (10128, 10130),
                (10022, 10035),
                (10007, 10138),
                (10063, 10101),
                (10036, 10096),
                (10036, 10095),
                (10007, 10131),
                (10007, 10130),
                (10007, 10132),
                (10067, 10128),
                (10007, 10137),
                (10082, 10104),
                (10041, 10122),
                (10036, 10086),
                (10035, 10082),
                (0, 10009),
                (10082, 10141),
                (0, 10002),
                (10067, 10138),
                (0, 10007),
                (0, 10006),
                (0, 10005),
                (10068, 10074),
                (10068, 10076),
                (10068, 10071),
                (10005, 10108),
                (10052, 10092),
                (10068, 10078),
                (10080, 10156),
                (10120, 10145),
                (10075, 10090),
                (10082, 10137),
                (10082, 10130),
                (10075, 10094),
                (10025, 10120),
                (10075, 10096),
                (10082, 10138),
                (10074, 10118),
                (10074, 10111),
                (10074, 10113),
                (10151, 10169),
                (10074, 10115),
                (10074, 10116),
                (10076, 10077),
                (10143, 10157),
                (10105, 10137),
                (10088, 10091),
                (10027, 10083),
                (10027, 10080),
                (10027, 10087),
                (10027, 10086),
                (10011, 10020),
                (10014, 10122),
                (10016, 10085),
                (10016, 10083),
                (10016, 10082),
                (10016, 10081),
                (10088, 10090),
                (10124, 10155),
                (10016, 10088),
                (10155, 10157),
                (10155, 10156),
                (10065, 10120),
                (10124, 10154),
                (10083, 10086),
                (10083, 10089),
                (10031, 10152),
                (10065, 10128),
                (10029, 10146),
                (10112, 10137),
                (10064, 10083),
                (10022, 10125),
                (10112, 10130),
                (10112, 10131),
                (10151, 10153),
                (10151, 10152),
                (10059, 10137),
                (10059, 10130),
                (10059, 10131),
                (10151, 10155),
                (10067, 10151),
                (10089, 10125),
                (10089, 10126),
                (10089, 10120),
                (10029, 10116),
                (10089, 10122),
                (10049, 10112),
                (10089, 10128),
                (10004, 10007),
                (10014, 10134),
                (10014, 10137),
                (10029, 10115),
                (10014, 10130),
                (10072, 10082),
                (10075, 10100),
                (10075, 10077),
                (10014, 10138),
                (10088, 10173),
                (10028, 10128),
                (10131, 10143),
                (10028, 10122),
                (10006, 10075),
                (10096, 10118),
                (10088, 10089),
                (10006, 10073),
                (10143, 10151),
                (10076, 10156),
                (10039, 10045),
                (10076, 10153),
                (10070, 10101),
                (10011, 10172),
                (10064, 10101),
                (10029, 10044),
                (10031, 10134),
                (10029, 10041),
                (10020, 10068),
                (10031, 10130),
                (10031, 10131),
                (10072, 10152),
                (10072, 10151),
                (10029, 10049),
                (10031, 10138),
                (0, 10073),
                (10115, 10153),
                (10090, 10149),
                (10021, 10128),
                (10085, 10093),
                (10115, 10156),
                (10062, 10167),
                (10085, 10097),
                (10062, 10169),
                (10090, 10141),
                (10070, 10086),
                (10021, 10124),
                (10021, 10125),
                (10015, 10034),
                (10015, 10036),
                (10015, 10031),
                (10015, 10039),
                (10021, 10062),
                (10090, 10091),
                (10090, 10094),
                (10090, 10095),
                (10006, 10149),
                (10097, 10104),
                (10017, 10146),
                (10097, 10101),
                (10011, 10095),
                (10094, 10112),
                (10134, 10163),
                (10134, 10162),
                (10134, 10164),
                (10134, 10167),
                (10066, 10137),
                (10134, 10169),
                (10064, 10167),
                (10009, 10075),
                (10074, 10141),
                (10050, 10132),
                (10146, 10165),
                (10015, 10101),
                (10015, 10100),
                (10111, 10146),
                (10044, 10104),
                (10015, 10104),
                (10044, 10100),
                (10093, 10162),
                (10029, 10139),
                (10029, 10134),
                (10029, 10137),
                (10017, 10034),
                (10029, 10131),
                (10029, 10130),
                (10017, 10031),
                (10086, 10095),
                (10101, 10143),
                (10041, 10045),
                (10041, 10044),
                (10041, 10043),
                (10041, 10042),
                (10101, 10145),
                (10101, 10144),
                (10104, 10151),
                (10002, 10017),
                (10101, 10149),
                (10104, 10154),
                (10041, 10049),
                (10104, 10156),
                (10036, 10157),
                (10036, 10156),
                (10036, 10155),
                (10131, 10146),
                (10034, 10169),
                (10103, 10108),
                (10025, 10108),
                (10043, 10169),
                (10005, 10041),
                (10043, 10163),
                (10077, 10120),
                (10043, 10164),
                (10011, 10149),
                (10047, 10172),
                (10025, 10130),
                (10167, 10170),
                (10050, 10149),
                (10043, 10131),
                (10007, 10128),
                (10047, 10066),
                (10007, 10127),
                (10007, 10125),
                (10007, 10122),
                (10007, 10123),
                (10007, 10120),
                (10015, 10149),
                (10009, 10156),
                (10108, 10147),
                (10022, 10045),
                (10094, 10130),
                (0, 10011),
                (0, 10013),
                (0, 10015),
                (10015, 10146),
                (10067, 10068),
                (10009, 10016),
                (10011, 10146),
                (10127, 10137),
                (10013, 10145),
                (10007, 10011),
                (10007, 10016),
                (10015, 10143),
                (10007, 10014),
                (10127, 10131),
                (10005, 10102),
                (10005, 10103),
                (10033, 10114),
                (10005, 10104),
                (10075, 10086),
                (10016, 10161),
                (10016, 10162),
                (10075, 10085),
                (10075, 10082),
                (10016, 10167),
                (10016, 10169),
                (10094, 10159),
                (10050, 10169),
                (10074, 10107),
                (10074, 10104),
                (10071, 10145),
                (10074, 10101),
                (10061, 10086),
                (10061, 10083),
                (10061, 10082),
                (10061, 10088),
                (10105, 10146),
                (10049, 10062),
                (10105, 10143),
                (10036, 10138),
                (10105, 10148),
                (10027, 10091),
                (10027, 10094),
                (10045, 10153),
                (10002, 10164),
                (10045, 10152),
                (10002, 10131),
                (10016, 10095),
                (10073, 10075),
                (10073, 10074),
                (10059, 10073),
                (10083, 10094),
                (10089, 10112),
                (10074, 10076),
                (10083, 10090),
                (10083, 10091),
                (10003, 10083),
                (10128, 10138),
                (10061, 10159),
                (10063, 10065),
                (10063, 10067),
                (10156, 10164),
                (10082, 10101),
                (10082, 10100),
                (10061, 10151),
                (10128, 10134),
                (10128, 10137),
                (10126, 10137),
                (10047, 10073),
                (10130, 10138),
                (10023, 10152),
                (10113, 10137),
                (10083, 10144),
                (10014, 10128),
                (10063, 10083),
                (10124, 10156),
                (10014, 10120),
                (10124, 10153),
                (10063, 10086),
                (10014, 10124),
                (10104, 10116),
                (10036, 10082),
                (10016, 10113),
                (10039, 10159),
                (10136, 10137),
                (10088, 10107),
                (10002, 10019),
                (10088, 10104),
                (10088, 10101),
                (10011, 10090),
                (10031, 10091),
                (10031, 10093),
                (10031, 10095),
                (10031, 10094),
                (10031, 10097),
                (10006, 10066),
                (10006, 10067),
                (10006, 10065),
                (10006, 10068),
                (10014, 10015),
                (0, 10032),
                (10143, 10147),
                (10089, 10118),
                (10015, 10029),
                (10064, 10112),
                (10089, 10111),
                (10089, 10110),
                (10089, 10113),
                (10049, 10101),
                (10059, 10075),
                (10059, 10074),
                (10049, 10104),
                (10062, 10173),
                (10115, 10147),
                (10048, 10057),
                (10015, 10022),
                (10115, 10145),
                (10115, 10146),
                (10021, 10156),
                (10070, 10090),
                (10021, 10155),
                (10021, 10154),
                (10021, 10152),
                (10021, 10151),
                (10090, 10172),
                (10015, 10021),
                (10107, 10146),
                (10062, 10072),
                (10033, 10169),
                (10096, 10170),
                (10033, 10163),
                (10085, 10141),
                (10033, 10167),
                (10033, 10164),
                (10017, 10152),
                (10017, 10153),
                (10017, 10155),
                (10017, 10156),
                (10097, 10113),
                (10028, 10045),
                (10028, 10047),
                (10112, 10116),
                (10028, 10041),
                (10028, 10043),
                (10015, 10134),
                (10028, 10048),
                (10028, 10049),
                (10041, 10075),
                (10143, 10166),
                (10015, 10115),
                (10015, 10112),
                (10015, 10113),
                (10085, 10134),
                (10029, 10122),
                (10029, 10123),
                (10029, 10120),
                (10017, 10028),
                (10017, 10029),
                (10029, 10124),
                (10039, 10082),
                (10029, 10128),
                (10017, 10022),
                (10017, 10023),
                (10154, 10163),
                (10154, 10162),
                (10101, 10152),
                (10078, 10101),
                (10154, 10167),
                (10154, 10166),
                (10104, 10148),
                (10104, 10149),
                (10101, 10159),
                (10136, 10143),
                (10104, 10145),
                (10136, 10145),
                (10104, 10143),
                (10034, 10156),
                (10036, 10145),
                (10036, 10147),
                (10019, 10048),
                (10019, 10049),
                (10016, 10065),
                (10014, 10145),
                (10019, 10041),
                (10019, 10043),
                (10131, 10164),
                (10019, 10045),
                (10019, 10046),
                (10019, 10047),
                (10035, 10072),
                (10082, 10134),
                (10047, 10163),
                (10035, 10071),
                (10067, 10104),
                (10067, 10100),
                (10067, 10101),
                (10075, 10120),
                (10048, 10101),
                (10112, 10117),
                (10034, 10086),
                (10043, 10066),
                (10077, 10162),
                (0, 10027),
                (0, 10026),
                (0, 10021),
                (0, 10020),
                (10017, 10151),
                (10046, 10047),
                (0, 10029),
                (10067, 10072),
                (10067, 10070),
                (10067, 10071),
                (10020, 10089),
                (10009, 10029),
                (10020, 10125),
                (10047, 10138),
                (10013, 10155),
                (10007, 10065),
                (10135, 10165),
                (10135, 10167),
                (10007, 10068),
                (10016, 10155),
                (10016, 10157),
                (10016, 10156),
                (10016, 10153),
                (10086, 10151),
                (10094, 10149),
                (10122, 10139),
                (10122, 10138),
                (10061, 10090),
                (10122, 10137),
                (10122, 10134),
                (10068, 10123),
                (10129, 10166),
                (10113, 10149),
                (10068, 10126),
                (10068, 10125),
                (10081, 10120),
                (10068, 10128),
                (10066, 10127),
                (10129, 10169),
                (10071, 10090),
                (10016, 10017),
                (10114, 10122),
                (10125, 10169),
                (10114, 10120),
                (10020, 10086),
                (10086, 10159),
                (10125, 10167),
                (10112, 10138),
                (10089, 10137),
                (10002, 10172),
                (10009, 10120),
                (10022, 10095),
                (10022, 10096),
                (10042, 10155),
                (10042, 10152),
                (10042, 10151),
                (10145, 10162),
                (10002, 10123),
                (10135, 10146),
                (10071, 10101),
                (10071, 10100),
                (10065, 10141),
                (10081, 10122),
                (10071, 10104),
                (10059, 10112),
                (10059, 10113),
                (10059, 10111),
                (10135, 10143),
                (10013, 10016),
                (10085, 10138),
                (10063, 10090),
                (10014, 10156),
                (10014, 10155),
                (10014, 10153),
                (10014, 10151),
                (10124, 10143),
                (10042, 10082),
                (10039, 10062),
                (10020, 10164),
                (10028, 10101),
                (10011, 10086),
                (10085, 10130),
                (10028, 10104),
                (10031, 10088),
                (10031, 10089),
                (10031, 10086),
                (10002, 10003),
                (10002, 10005),
                (10031, 10081),
                (10006, 10017),
                (10006, 10016),
                (10006, 10015),
                (10006, 10014),
                (10006, 10013),
                (10006, 10011),
                (10047, 10063),
                (10006, 10019),
                (10011, 10156),
                (10011, 10155),
                (10011, 10152),
                (10039, 10138),
                (10011, 10151),
                (0, 10165),
                (10089, 10108),
                (10089, 10105),
                (10023, 10146),
                (10049, 10172),
                (10029, 10127),
                (10145, 10172),
                (10061, 10104),
                (10117, 10147),
                (10029, 10125),
                (10090, 10163),
                (10006, 10128),
                (10090, 10164),
                (10017, 10025),
                (10006, 10123),
                (10006, 10122),
                (10021, 10146),
                (10006, 10120),
                (10006, 10127),
                (10021, 10141),
                (10006, 10125),
                (10021, 10143),
                (10107, 10156),
                (10107, 10155),
                (10107, 10153),
                (10107, 10151),
                (10144, 10162),
                (10044, 10144),
                (10144, 10167),
                (10033, 10170),
                (10033, 10171),
                (10045, 10134),
                (10017, 10164),
                (10101, 10151),
                (10028, 10075),
                (10154, 10161),
                (10101, 10153),
                (10101, 10154),
                (10085, 10128),
                (10044, 10125),
                (10154, 10165),
                (10085, 10120),
                (10085, 10123),
                (10020, 10041),
                (10034, 10151),
                (10029, 10155),
                (10029, 10154),
                (10029, 10153),
                (10029, 10151),
                (10064, 10094),
                (10017, 10019),
                (10123, 10129),
                (10154, 10169),
                (10101, 10164),
                (10101, 10167),
                (10034, 10152),
                (10101, 10163),
                (10136, 10156),
                (10034, 10155),
                (10136, 10154),
                (10034, 10145),
                (10101, 10169),
                (10136, 10153),
                (10118, 10131),
                (10048, 10065),
                (10066, 10122),
                (10048, 10062),
                (10029, 10045),
                (10034, 10125),
                (10131, 10155),
                (10131, 10154),
                (10131, 10156),
                (10131, 10151),
                (10131, 10153),
                (10020, 10131),
                (10043, 10104),
                (10108, 10154),
                (10097, 10123),
                (10097, 10122),
                (10043, 10101),
                (10033, 10082),
                (10036, 10146),
                (10045, 10086),
                (10065, 10122),
                (10138, 10143),
                (10144, 10165),
                (10045, 10082),
                (10115, 10137),
                (10041, 10068),
                (10041, 10067),
                (10041, 10066),
                (10077, 10170),
                (0, 10033),
                (0, 10031),
                (10005, 10016),
                (0, 10035),
                (0, 10039),
                (10145, 10151),
                (10147, 10153),
                (10009, 10036),
                (10082, 10144),
                (10009, 10033),
                (10009, 10031),
                (10007, 10074),
                (10007, 10075),
                (10007, 10076),
                (10135, 10155),
                (10007, 10072),
                (10007, 10073),
                (10005, 10164),
                (10005, 10165),
                (10131, 10162),
                (10005, 10162),
                (10016, 10043),
                (10066, 10118),
                (10016, 10041),
                (10103, 10113),
                (10122, 10128),
                (10122, 10129),
                (10104, 10136),
                (10122, 10123),
                (10122, 10125),
                (10068, 10134),
                (10022, 10075),
                (10068, 10137),
                (10068, 10138),
                (10039, 10145),
                (10120, 10141),
                (10081, 10124),
                (10114, 10132),
                (10011, 10033),
                (10091, 10134),
                (10002, 10145),
                (10025, 10043),
                (10082, 10146),
                (10002, 10141),
                (10025, 10044),
                (10002, 10143),
                (10022, 10086),
                (10025, 10113),
                (10022, 10082),
                (10046, 10123),
                (10128, 10173),
                (10155, 10169),
                (10155, 10166),
                (10155, 10167),
                (10065, 10173),
                (10050, 10125),
                (10155, 10162),
                (10155, 10161),
                (10043, 10061),
                (10071, 10113),
                (10003, 10067),
                (10046, 10091),
                (10145, 10156),
                (10046, 10094),
                (10151, 10167),
                (10151, 10164),
                (10151, 10165),
                (10094, 10171),
                (10016, 10146),
                (10016, 10145),
                (10073, 10122),
                (10075, 10114),
                (10045, 10172),
                (10043, 10050),
                (10031, 10123),
                (10039, 10104),
                (10087, 10094),
                (10029, 10074),
                (10110, 10146),
                (10014, 10031),
                (10031, 10073),
                (10031, 10071),
                (10002, 10039),
                (10031, 10076),
                (10031, 10075),
                (10031, 10074),
                (10002, 10035),
                (10002, 10034),
                (10023, 10049),
                (10109, 10113),
                (10002, 10031),
                (10083, 10164),
                (10002, 10033),
                (10031, 10042),
                (10006, 10007),
                (10076, 10169),
                (10076, 10167),
                (10076, 10162),
                (10076, 10163),
                (10031, 10041),
                (10028, 10031),
                (10029, 10034),
                (10033, 10138),
                (10029, 10036),
                (10029, 10031),
                (10072, 10163),
                (10049, 10169),
                (10049, 10164),
                (10031, 10045),
                (10023, 10132),
                (10023, 10131),
                (10049, 10163),
                (10102, 10118),
                (10115, 10162),
                (10115, 10161),
                (10115, 10166),
                (10115, 10167),
                (10115, 10165),
                (10006, 10138),
                (10021, 10173),
                (10015, 10049),
                (10111, 10156),
                (10006, 10130),
                (10006, 10131),
                (10046, 10128),
                (10006, 10134),
                (10111, 10155),
                (10006, 10136),
                (10006, 10137),
                (10104, 10130),
                (10016, 10163),
                (10007, 10096),
                (10144, 10156),
                (10144, 10151),
                (10144, 10153),
                (10144, 10152),
                (10088, 10128),
                (10033, 10149),
                (10033, 10145),
                (10033, 10144),
                (10088, 10123),
                (10033, 10141),
                (10088, 10124),
                (10033, 10143),
                (10016, 10164),
                (10028, 10065),
                (10028, 10062),
                (10108, 10153),
                (10069, 10094),
                (10016, 10165),
                (10044, 10137),
                (10013, 10015),
                (10044, 10131),
                (10085, 10115),
                (10085, 10111),
                (10085, 10112),
                (10029, 10145),
                (10138, 10141),
                (10029, 10147),
                (10138, 10146),
                (10064, 10086),
                (10029, 10143),
                (10138, 10149),
                (10060, 10090),
                (10036, 10169),
                (10036, 10162),
                (10036, 10166),
                (10036, 10167),
                (10066, 10138),
                (10091, 10096),
                (10015, 10124),
                (10066, 10134),
                (10066, 10132),
                (10091, 10095),
                (10066, 10131),
                (10019, 10062),
                (10085, 10088),
                (10019, 10067),
                (10131, 10144),
                (10131, 10145),
                (10131, 10148),
                (10062, 10151),
                (10108, 10143),
                (10035, 10075),
                (10043, 10132),
                (10108, 10146),
                (10043, 10134),
                (10108, 10144),
                (10043, 10138),
                (10097, 10134),
                (10097, 10132),
                (10097, 10130),
                (10002, 10041),
                (10020, 10123),
                (10039, 10167),
                (10034, 10045),
                (10034, 10044),
                (10034, 10042),
                (10034, 10041),
                (10130, 10136),
                (10130, 10137),
                (10130, 10134),
                (10130, 10132),
                (10034, 10049),
                (10021, 10130),
                (10021, 10113),
                (10121, 10136),
                (10101, 10173),
                (10035, 10101),
                (10101, 10171),
                (10041, 10072),
                (10041, 10071),
                (10046, 10064),
                (10138, 10171),
                (10046, 10062),
                (10027, 10052),
                (10005, 10023),
                (10005, 10022),
                (10005, 10029),
                (10096, 10165),
                (10088, 10100),
                (10005, 10007),
                (10075, 10134),
                (10143, 10162),
                (10005, 10006),
                (10007, 10049),
                (10075, 10135),
                (10112, 10114),
                (10136, 10162),
                (10007, 10043),
                (0, 10022),
                (10007, 10045),
                (10005, 10151),
                (10005, 10153),
                (10135, 10145),
                (10005, 10154),
                (10005, 10156),
                (10075, 10131),
                (10034, 10153),
                (10100, 10149),
                (10068, 10104),
                (10068, 10101),
                (10068, 10100),
                (10062, 10097),
                (10125, 10147),
                (10125, 10146),
                (10147, 10156),
                (10147, 10154),
                (10147, 10155),
                (10022, 10073),
                (10022, 10072),
                (10050, 10083),
                (10050, 10082),
                (10050, 10086),
                (10050, 10089),
                (10050, 10088),
                (10068, 10151),
                (10082, 10156),
                (10065, 10169),
                (10065, 10167),
                (10065, 10164),
                (10065, 10162),
                (10065, 10163),
                (10102, 10113),
                (10071, 10124),
                (10033, 10137),
                (10071, 10123),
                (10046, 10080),
                (10046, 10083),
                (10071, 10128),
                (10046, 10086),
                (10061, 10163),
                (10097, 10138),
                (10061, 10164),
                (10016, 10138),
                (10016, 10137),
                (10016, 10136),
                (10061, 10169),
                (10016, 10132),
                (10016, 10130),
                (10166, 10167),
                (10104, 10146),
                (10028, 10138),
                (10006, 10124),
                (10124, 10167),
                (10073, 10130),
                (10073, 10137),
                (10149, 10169),
                (10083, 10152),
                (10083, 10118),
                (10104, 10147),
                (10082, 10155),
                (10020, 10141),
                (10083, 10111),
                (10104, 10153),
                (10002, 10152),
                (10020, 10144),
                (10002, 10151),
                (10002, 10156),
                (10002, 10157),
                (10016, 10045)
                ]

contacts = {}   # id --> temp --> set(ids)
locations = {}  # id --> temp --> location

def find_timeslots(motes,
                   min_slot_duration,
                   occupation_cutoff,
                   percent_change_cutoff):
    
    global locations
    
    timeline = {}
    criterion_timeline = {}
    
    for t in range(500, 3000):
        timeline[t] = set()
        for i in locations:
            if t in locations[i]:
                if locations[i][t] in motes:
                    timeline[t].add(i)
    
    for t in range(502, 2996):    # (502, 2996)
        set1 = timeline[t-2] | timeline [t-1] | timeline [t+0]
        set2 = timeline[t+1] | timeline [t+2] | timeline [t+3]
        union = float(len(set1 | set2))
        intersection = float(len(set1 & set2))
        if union > 0:
            jaccard = intersection/union
        else:
            jaccard = 0.0
        if union < occupation_cutoff:
            criterion_timeline[t] = None
        else:
            if jaccard < percent_change_cutoff:
                criterion_timeline[t] = False
            else:
                criterion_timeline[t] = True
    
    list_of_slots = []
    
    flag = False
    for t in range(502, 2996):
        if flag == False:
            if criterion_timeline[t] == True:
                start_val = t + 1
                flag = True
        else:
            if criterion_timeline[t] != True:
                if (t - start_val) >= min_slot_duration:
                    list_of_slots.append((start_val, t))
                flag = False
    
    return list_of_slots

def correct_locations(motes,
                      timespan,
                      presence_cutoff,
                      contact_cutoff,
                      groupsize_cutoff):
    
    min_time = timespan[0]
    max_time = timespan[1]
    
    set_of_nodes = set()
    
    loc_counter = {}
    for i in locations:
        counter = 0
        loc_counter[i] = {}
        loc_counter[i][motes[0]] = 0
        loc_counter[i][motes[1]] = 0
        for t in range(min_time, max_time+1):
            if not t in locations[i]: continue
            if locations[i][t] in motes:
                loc_counter[i][locations[i][t]] += 1
                counter += 1
        if counter > presence_cutoff: set_of_nodes.add(i)
    
    G = nx.Graph()
    
    for i in set_of_nodes:
        if not i in contacts: continue
        cont_counter = {}
        for j in set_of_nodes:
            cont_counter[j] = 0
        for t in range(min_time, max_time+1):
            if not t in contacts[i]: continue
            for j in contacts[i][t]:
                if j in set_of_nodes: cont_counter[j] += 1
        for j in cont_counter:
            if cont_counter[j] > contact_cutoff:
                G.add_edge(i,j,weight=cont_counter[j])
    
    components = nx.algorithms.components.connected.connected_components(G)
    
    remain_comps = []
    
    for comp in components:
        if len(comp) > groupsize_cutoff:
            remain_comps.append(comp)
    
    if len(remain_comps) == 1:
        mote1 = 0
        mote2 = 0
        for i in remain_comps[0]:
            mote1 += loc_counter[i][motes[0]]
            mote2 += loc_counter[i][motes[1]]
        if (((float(mote1)/float(mote1+mote2)) < 0.1) or
           ((float(mote1)/float(mote1+mote2)) > 0.9)):
            print "(%5i %5i) (%4i %4i) %3.0f %1i %2i (%4i %4i) %1.4f" %(motes[0],
                                                                    motes[1],
                                                                    timespan[0],
                                                                    timespan[1],
                                                                    float(timespan[1]-timespan[0])/(3.0),
                                                                    1,
                                                                    len(remain_comps[0]),
                                                                    mote1,
                                                                    mote2,
                                                                    (float(mote1)/float(mote1+mote2)))
        else:
            print "(%5i %5i) (%4i %4i) %3.0f %1i %2i (%4i %4i) %1.4f <--" %(motes[0],
                                                                    motes[1],
                                                                    timespan[0],
                                                                    timespan[1],
                                                                    float(timespan[1]-timespan[0])/(3.0),
                                                                    1,
                                                                    len(remain_comps[0]),
                                                                    mote1,
                                                                    mote2,
                                                                    (float(mote1)/float(mote1+mote2)))
        if (float(mote1)/float((mote1+mote2))) > 0.5:
            for i in remain_comps[0]:
                for t in range(min_time, max_time+1): 
                    if not t in locations[i]: continue
                    if locations[i][t] in motes:
                        locations[i][t] = motes[0]
        elif (float(mote2)/float((mote1+mote2))) > 0.5:
            for i in remain_comps[0]:
                for t in range(min_time, max_time+1): 
                    if not t in locations[i]: continue
                    if locations[i][t] in motes:
                        locations[i][t] = motes[1]
    elif len(remain_comps) == 2:
        percent = []
        for i in [0, 1]:
            mote1 = 0
            mote2 = 0
            for j in remain_comps[i]:
                mote1 += loc_counter[j][motes[0]]
                mote2 += loc_counter[j][motes[1]]
            if (((float(mote1)/float(mote1+mote2)) < 0.1) or
               ((float(mote1)/float(mote1+mote2)) > 0.9)):
                print "(%5i %5i) (%4i %4i) %3.0f %1i %2i (%4i %4i) %1.4f" %(motes[0],
                                                                        motes[1],
                                                                        timespan[0],
                                                                        timespan[1],
                                                                        float(timespan[1]-timespan[0])/(3.0),
                                                                        2,
                                                                        len(remain_comps[i]),
                                                                        mote1,
                                                                        mote2,
                                                                        float(mote1)/float(mote1+mote2))
            else:
                print "(%5i %5i) (%4i %4i) %3.0f %1i %2i (%4i %4i) %1.4f <--" %(motes[0],
                                                                        motes[1],
                                                                        timespan[0],
                                                                        timespan[1],
                                                                        float(timespan[1]-timespan[0])/(3.0),
                                                                        2,
                                                                        len(remain_comps[i]),
                                                                        mote1,
                                                                        mote2,
                                                                        float(mote1)/float(mote1+mote2))
            percent.append(float(mote1)/float((mote1+mote2)))
        if ((percent[0] > 0.5) or (percent[1] > 0.5) or
            (percent[0] < (1 - 0.5)) or (percent[1] < (1 - 0.5))):
                if percent[0] < percent[1]:
                    for i in remain_comps[0]:
                        for t in range(min_time, max_time+1):
                            if not t in locations[i]: continue
                            if locations[i][t] in motes:
                                locations[i][t] = motes[1]
                    for i in remain_comps[1]:
                        for t in range(min_time, max_time+1): 
                            if not t in locations[i]: continue
                            if locations[i][t] in motes:
                                locations[i][t] = motes[0]
                else:
                    for i in remain_comps[0]:
                        for t in range(min_time, max_time+1): 
                            if not t in locations[i]: continue
                            if locations[i][t] in motes:
                                locations[i][t] = motes[0]
                    for i in remain_comps[1]:
                        for t in range(min_time, max_time+1): 
                            if not t in locations[i]: continue
                            if locations[i][t] in motes:
                                locations[i][t] = motes[1]
    elif len(remain_comps) > 2:
        for comp in remain_comps:
            mote1 = 0
            mote2 = 0
            for i in comp:
                mote1 += loc_counter[i][motes[0]]
                mote2 += loc_counter[i][motes[1]]
            if (((float(mote1)/float(mote1+mote2)) < 0.1) or
               ((float(mote1)/float(mote1+mote2)) > 0.9)):
                print "(%5i %5i) (%4i %4i) %3.0f %1i %2i (%4i %4i) %1.4f" %(motes[0],
                                                                        motes[1],
                                                                        timespan[0],
                                                                        timespan[1],
                                                                        float(timespan[1]-timespan[0])/(3.0),
                                                                        len(remain_comps),
                                                                        len(comp),
                                                                        mote1,
                                                                        mote2,
                                                                        (float(mote1)/float(mote1+mote2)))
            else:
                print "(%5i %5i) (%4i %4i) %3.0f %1i %2i (%4i %4i) %1.4f <--" %(motes[0],
                                                                        motes[1],
                                                                        timespan[0],
                                                                        timespan[1],
                                                                        float(timespan[1]-timespan[0])/(3.0),
                                                                        len(remain_comps),
                                                                        len(comp),
                                                                        mote1,
                                                                        mote2,
                                                                        (float(mote1)/float(mote1+mote2)))
            if (float(mote1)/float((mote1+mote2))) > 0.5:
                for i in comp:
                    for t in range(min_time, max_time+1): 
                        if not t in locations[i]: continue
                        if locations[i][t] in motes:
                            locations[i][t] = motes[0]
            elif (float(mote2)/float((mote1+mote2))) > 0.5:
                for i in comp:
                    for t in range(min_time, max_time+1): 
                        if not t in locations[i]: continue
                        if locations[i][t] in motes:
                            locations[i][t] = motes[1]

def unify_neighbors(time,
                    id):
    
    global locations
    global contacts
    
    dict_of_locations = {}
    dict_of_locations[0] = 0
    
    if time in locations[id]:
        id_loc = locations[id][time]
    else:
        id_loc = 0
    
    if not id in contacts:
        return False
    
    if t in contacts[id]:
        for i in contacts[id][t]:
            if t in locations[i]:
                if locations[i][t] in dict_of_locations:
                    dict_of_locations[locations[i][t]] += 1
                else:
                    dict_of_locations[locations[i][t]] = 1
            else:
                dict_of_locations[0] += 1
        for loc in dict_of_locations:
            if ((float(dict_of_locations[loc])/float(len(contacts[id][t])))
                > 0.5):
                if loc != id_loc:
                    locations[id][t] = loc
                    return True
                break
    return False

def save_location_data(filename, id):
    
    global locations
    
    output = open(filename, 'w')
    for t in range(500, 3000):
        if t in locations[id]:
            if locations[id][t] != 0:
                output.write("%6i%6i\n"%(t,locations[id][t]))

def read_location_data(filename, id):
    
    global locations
    cnt = 0
    
    input = open(filename, 'r')
    for line in input:
        cnt += 1
        time = int(line[0:6].strip())
        location = int(line[6:12].strip())
        add_location(id, time, location)
    
    return cnt

def read_contact_data(filename, id1):
    
    global contacts
    
    input = open(filename, 'r')
    for line in input:
        time = int(line.split()[4])
        id2 = int(line.split()[0])
        if id2 > 1000: continue
        add_contact(id1, id2, time)

def add_location(id, time, location):
    
    global locations
    
    if not id in locations:
        locations[id] = {}
    
    if not time in locations[id]:
        locations[id][time] = location
    else:
        print "Error"

def add_contact(id1, id2, time):
    
    global contacts
    
    if not id1 in contacts:
        contacts[id1] = {}
    
    if not id2 in contacts:
        contacts[id2] = {}
    
    if not time in contacts[id1]:
        contacts[id1][time] = set([id2])
    else:
        contacts[id1][time].add(id2)
    
    if not time in contacts[id2]:
        contacts[id2][time] = set([id1])
    else:
        contacts[id2][time].add(id1)

counter = 0
for i in range(1, 790):
    print "read %0i" %(i)
    filename_loc = "../locations2/location_node-%0i" %(i)
    cnt = read_location_data(filename_loc, i)
    counter += cnt
    filename_cont = "../Raw_data_school_2010/node-%0i" %(i)
    read_contact_data(filename_cont, i)

for motes in COMBINATIONS:
    slots = find_timeslots(motes, 90, 10, 0.5)
    for slot in slots:
        correct_locations(motes,
                          slot,
                          int((slot[1]-slot[0])*0.5),
                          int((slot[1]-slot[0])*0.5),
                          4)

for iter in range(0, 3):
    for i in range(1, 790):
        counter = 0
        for t in range(500, 2500):
            if unify_neighbors(t,i) == True:
                counter += 1
        print "unify %0i, %0i changes" %(i, counter)

for motes in COMBINATIONS:
    slots = find_timeslots(motes, 90, 10, 0.5)
    for slot in slots:
        correct_locations(motes,
                          slot,
                          int((slot[1]-slot[0])*0.5),
                          int((slot[1]-slot[0])*0.5),
                          4)


for i in range(1, 790):
    print "write %0i" %(i)
    filename_loc = "./locations4/location_node-%0i" %(i)
    save_location_data(filename_loc, i)

